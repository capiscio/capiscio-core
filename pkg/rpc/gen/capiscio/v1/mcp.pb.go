// MCP Service - Tool Authority and Server Identity (RFC-006, RFC-007)
//
// This service provides unified MCP security features:
// - Tool access evaluation with trust badge verification (RFC-006)
// - Server identity verification (RFC-007)
// - Health check with version compatibility
//
// Key design principles:
// - Single RPC for decision+evidence (atomic operation)
// - params_hash only, never raw params (canonicalization in wrapper)
// - oneof caller_credential (core derives DID/JTI/auth_level)

// Code generated by protoc-gen-go. DO NOT EDIT.
// versions:
// 	protoc-gen-go v1.36.6
// 	protoc        (unknown)
// source: capiscio/v1/mcp.proto

package capisciov1

import (
	protoreflect "google.golang.org/protobuf/reflect/protoreflect"
	protoimpl "google.golang.org/protobuf/runtime/protoimpl"
	timestamppb "google.golang.org/protobuf/types/known/timestamppb"
	reflect "reflect"
	sync "sync"
	unsafe "unsafe"
)

const (
	// Verify that this generated code is sufficiently up-to-date.
	_ = protoimpl.EnforceVersion(20 - protoimpl.MinVersion)
	// Verify that runtime/protoimpl is sufficiently up-to-date.
	_ = protoimpl.EnforceVersion(protoimpl.MaxVersion - 20)
)

// Access decision enum
type MCPDecision int32

const (
	MCPDecision_MCP_DECISION_UNSPECIFIED MCPDecision = 0
	MCPDecision_MCP_DECISION_ALLOW       MCPDecision = 1
	MCPDecision_MCP_DECISION_DENY        MCPDecision = 2
)

// Enum value maps for MCPDecision.
var (
	MCPDecision_name = map[int32]string{
		0: "MCP_DECISION_UNSPECIFIED",
		1: "MCP_DECISION_ALLOW",
		2: "MCP_DECISION_DENY",
	}
	MCPDecision_value = map[string]int32{
		"MCP_DECISION_UNSPECIFIED": 0,
		"MCP_DECISION_ALLOW":       1,
		"MCP_DECISION_DENY":        2,
	}
)

func (x MCPDecision) Enum() *MCPDecision {
	p := new(MCPDecision)
	*p = x
	return p
}

func (x MCPDecision) String() string {
	return protoimpl.X.EnumStringOf(x.Descriptor(), protoreflect.EnumNumber(x))
}

func (MCPDecision) Descriptor() protoreflect.EnumDescriptor {
	return file_capiscio_v1_mcp_proto_enumTypes[0].Descriptor()
}

func (MCPDecision) Type() protoreflect.EnumType {
	return &file_capiscio_v1_mcp_proto_enumTypes[0]
}

func (x MCPDecision) Number() protoreflect.EnumNumber {
	return protoreflect.EnumNumber(x)
}

// Deprecated: Use MCPDecision.Descriptor instead.
func (MCPDecision) EnumDescriptor() ([]byte, []int) {
	return file_capiscio_v1_mcp_proto_rawDescGZIP(), []int{0}
}

// Authentication level enum
type MCPAuthLevel int32

const (
	MCPAuthLevel_MCP_AUTH_LEVEL_UNSPECIFIED MCPAuthLevel = 0
	MCPAuthLevel_MCP_AUTH_LEVEL_ANONYMOUS   MCPAuthLevel = 1
	MCPAuthLevel_MCP_AUTH_LEVEL_API_KEY     MCPAuthLevel = 2
	MCPAuthLevel_MCP_AUTH_LEVEL_BADGE       MCPAuthLevel = 3
)

// Enum value maps for MCPAuthLevel.
var (
	MCPAuthLevel_name = map[int32]string{
		0: "MCP_AUTH_LEVEL_UNSPECIFIED",
		1: "MCP_AUTH_LEVEL_ANONYMOUS",
		2: "MCP_AUTH_LEVEL_API_KEY",
		3: "MCP_AUTH_LEVEL_BADGE",
	}
	MCPAuthLevel_value = map[string]int32{
		"MCP_AUTH_LEVEL_UNSPECIFIED": 0,
		"MCP_AUTH_LEVEL_ANONYMOUS":   1,
		"MCP_AUTH_LEVEL_API_KEY":     2,
		"MCP_AUTH_LEVEL_BADGE":       3,
	}
)

func (x MCPAuthLevel) Enum() *MCPAuthLevel {
	p := new(MCPAuthLevel)
	*p = x
	return p
}

func (x MCPAuthLevel) String() string {
	return protoimpl.X.EnumStringOf(x.Descriptor(), protoreflect.EnumNumber(x))
}

func (MCPAuthLevel) Descriptor() protoreflect.EnumDescriptor {
	return file_capiscio_v1_mcp_proto_enumTypes[1].Descriptor()
}

func (MCPAuthLevel) Type() protoreflect.EnumType {
	return &file_capiscio_v1_mcp_proto_enumTypes[1]
}

func (x MCPAuthLevel) Number() protoreflect.EnumNumber {
	return protoreflect.EnumNumber(x)
}

// Deprecated: Use MCPAuthLevel.Descriptor instead.
func (MCPAuthLevel) EnumDescriptor() ([]byte, []int) {
	return file_capiscio_v1_mcp_proto_rawDescGZIP(), []int{1}
}

// Denial reason enum (RFC-006 §6.4)
type MCPDenyReason int32

const (
	MCPDenyReason_MCP_DENY_REASON_UNSPECIFIED        MCPDenyReason = 0
	MCPDenyReason_MCP_DENY_REASON_BADGE_MISSING      MCPDenyReason = 1 // Required but not provided
	MCPDenyReason_MCP_DENY_REASON_BADGE_INVALID      MCPDenyReason = 2 // Malformed or unverifiable
	MCPDenyReason_MCP_DENY_REASON_BADGE_EXPIRED      MCPDenyReason = 3
	MCPDenyReason_MCP_DENY_REASON_BADGE_REVOKED      MCPDenyReason = 4
	MCPDenyReason_MCP_DENY_REASON_TRUST_INSUFFICIENT MCPDenyReason = 5 // Trust level < min required
	MCPDenyReason_MCP_DENY_REASON_TOOL_NOT_ALLOWED   MCPDenyReason = 6 // Tool not in allowed list
	MCPDenyReason_MCP_DENY_REASON_ISSUER_UNTRUSTED   MCPDenyReason = 7
	MCPDenyReason_MCP_DENY_REASON_POLICY_DENIED      MCPDenyReason = 8 // Policy evaluation failed
)

// Enum value maps for MCPDenyReason.
var (
	MCPDenyReason_name = map[int32]string{
		0: "MCP_DENY_REASON_UNSPECIFIED",
		1: "MCP_DENY_REASON_BADGE_MISSING",
		2: "MCP_DENY_REASON_BADGE_INVALID",
		3: "MCP_DENY_REASON_BADGE_EXPIRED",
		4: "MCP_DENY_REASON_BADGE_REVOKED",
		5: "MCP_DENY_REASON_TRUST_INSUFFICIENT",
		6: "MCP_DENY_REASON_TOOL_NOT_ALLOWED",
		7: "MCP_DENY_REASON_ISSUER_UNTRUSTED",
		8: "MCP_DENY_REASON_POLICY_DENIED",
	}
	MCPDenyReason_value = map[string]int32{
		"MCP_DENY_REASON_UNSPECIFIED":        0,
		"MCP_DENY_REASON_BADGE_MISSING":      1,
		"MCP_DENY_REASON_BADGE_INVALID":      2,
		"MCP_DENY_REASON_BADGE_EXPIRED":      3,
		"MCP_DENY_REASON_BADGE_REVOKED":      4,
		"MCP_DENY_REASON_TRUST_INSUFFICIENT": 5,
		"MCP_DENY_REASON_TOOL_NOT_ALLOWED":   6,
		"MCP_DENY_REASON_ISSUER_UNTRUSTED":   7,
		"MCP_DENY_REASON_POLICY_DENIED":      8,
	}
)

func (x MCPDenyReason) Enum() *MCPDenyReason {
	p := new(MCPDenyReason)
	*p = x
	return p
}

func (x MCPDenyReason) String() string {
	return protoimpl.X.EnumStringOf(x.Descriptor(), protoreflect.EnumNumber(x))
}

func (MCPDenyReason) Descriptor() protoreflect.EnumDescriptor {
	return file_capiscio_v1_mcp_proto_enumTypes[2].Descriptor()
}

func (MCPDenyReason) Type() protoreflect.EnumType {
	return &file_capiscio_v1_mcp_proto_enumTypes[2]
}

func (x MCPDenyReason) Number() protoreflect.EnumNumber {
	return protoreflect.EnumNumber(x)
}

// Deprecated: Use MCPDenyReason.Descriptor instead.
func (MCPDenyReason) EnumDescriptor() ([]byte, []int) {
	return file_capiscio_v1_mcp_proto_rawDescGZIP(), []int{2}
}

// Server classification state (RFC-007 §5.2)
type MCPServerState int32

const (
	MCPServerState_MCP_SERVER_STATE_UNSPECIFIED        MCPServerState = 0
	MCPServerState_MCP_SERVER_STATE_VERIFIED_PRINCIPAL MCPServerState = 1 // Badge verified, trust level established
	MCPServerState_MCP_SERVER_STATE_DECLARED_PRINCIPAL MCPServerState = 2 // DID present but no/invalid badge
	MCPServerState_MCP_SERVER_STATE_UNVERIFIED_ORIGIN  MCPServerState = 3 // No identity disclosed (distinct from Trust Level 0)
)

// Enum value maps for MCPServerState.
var (
	MCPServerState_name = map[int32]string{
		0: "MCP_SERVER_STATE_UNSPECIFIED",
		1: "MCP_SERVER_STATE_VERIFIED_PRINCIPAL",
		2: "MCP_SERVER_STATE_DECLARED_PRINCIPAL",
		3: "MCP_SERVER_STATE_UNVERIFIED_ORIGIN",
	}
	MCPServerState_value = map[string]int32{
		"MCP_SERVER_STATE_UNSPECIFIED":        0,
		"MCP_SERVER_STATE_VERIFIED_PRINCIPAL": 1,
		"MCP_SERVER_STATE_DECLARED_PRINCIPAL": 2,
		"MCP_SERVER_STATE_UNVERIFIED_ORIGIN":  3,
	}
)

func (x MCPServerState) Enum() *MCPServerState {
	p := new(MCPServerState)
	*p = x
	return p
}

func (x MCPServerState) String() string {
	return protoimpl.X.EnumStringOf(x.Descriptor(), protoreflect.EnumNumber(x))
}

func (MCPServerState) Descriptor() protoreflect.EnumDescriptor {
	return file_capiscio_v1_mcp_proto_enumTypes[3].Descriptor()
}

func (MCPServerState) Type() protoreflect.EnumType {
	return &file_capiscio_v1_mcp_proto_enumTypes[3]
}

func (x MCPServerState) Number() protoreflect.EnumNumber {
	return protoreflect.EnumNumber(x)
}

// Deprecated: Use MCPServerState.Descriptor instead.
func (MCPServerState) EnumDescriptor() ([]byte, []int) {
	return file_capiscio_v1_mcp_proto_rawDescGZIP(), []int{3}
}

// Server verification error codes (RFC-007 §8)
type MCPServerErrorCode int32

const (
	MCPServerErrorCode_MCP_SERVER_ERROR_NONE               MCPServerErrorCode = 0
	MCPServerErrorCode_MCP_SERVER_ERROR_DID_INVALID        MCPServerErrorCode = 1
	MCPServerErrorCode_MCP_SERVER_ERROR_BADGE_INVALID      MCPServerErrorCode = 2
	MCPServerErrorCode_MCP_SERVER_ERROR_BADGE_EXPIRED      MCPServerErrorCode = 3
	MCPServerErrorCode_MCP_SERVER_ERROR_BADGE_REVOKED      MCPServerErrorCode = 4
	MCPServerErrorCode_MCP_SERVER_ERROR_TRUST_INSUFFICIENT MCPServerErrorCode = 5
	MCPServerErrorCode_MCP_SERVER_ERROR_ORIGIN_MISMATCH    MCPServerErrorCode = 6
	MCPServerErrorCode_MCP_SERVER_ERROR_PATH_MISMATCH      MCPServerErrorCode = 7
	MCPServerErrorCode_MCP_SERVER_ERROR_ISSUER_UNTRUSTED   MCPServerErrorCode = 8
)

// Enum value maps for MCPServerErrorCode.
var (
	MCPServerErrorCode_name = map[int32]string{
		0: "MCP_SERVER_ERROR_NONE",
		1: "MCP_SERVER_ERROR_DID_INVALID",
		2: "MCP_SERVER_ERROR_BADGE_INVALID",
		3: "MCP_SERVER_ERROR_BADGE_EXPIRED",
		4: "MCP_SERVER_ERROR_BADGE_REVOKED",
		5: "MCP_SERVER_ERROR_TRUST_INSUFFICIENT",
		6: "MCP_SERVER_ERROR_ORIGIN_MISMATCH",
		7: "MCP_SERVER_ERROR_PATH_MISMATCH",
		8: "MCP_SERVER_ERROR_ISSUER_UNTRUSTED",
	}
	MCPServerErrorCode_value = map[string]int32{
		"MCP_SERVER_ERROR_NONE":               0,
		"MCP_SERVER_ERROR_DID_INVALID":        1,
		"MCP_SERVER_ERROR_BADGE_INVALID":      2,
		"MCP_SERVER_ERROR_BADGE_EXPIRED":      3,
		"MCP_SERVER_ERROR_BADGE_REVOKED":      4,
		"MCP_SERVER_ERROR_TRUST_INSUFFICIENT": 5,
		"MCP_SERVER_ERROR_ORIGIN_MISMATCH":    6,
		"MCP_SERVER_ERROR_PATH_MISMATCH":      7,
		"MCP_SERVER_ERROR_ISSUER_UNTRUSTED":   8,
	}
)

func (x MCPServerErrorCode) Enum() *MCPServerErrorCode {
	p := new(MCPServerErrorCode)
	*p = x
	return p
}

func (x MCPServerErrorCode) String() string {
	return protoimpl.X.EnumStringOf(x.Descriptor(), protoreflect.EnumNumber(x))
}

func (MCPServerErrorCode) Descriptor() protoreflect.EnumDescriptor {
	return file_capiscio_v1_mcp_proto_enumTypes[4].Descriptor()
}

func (MCPServerErrorCode) Type() protoreflect.EnumType {
	return &file_capiscio_v1_mcp_proto_enumTypes[4]
}

func (x MCPServerErrorCode) Number() protoreflect.EnumNumber {
	return protoreflect.EnumNumber(x)
}

// Deprecated: Use MCPServerErrorCode.Descriptor instead.
func (MCPServerErrorCode) EnumDescriptor() ([]byte, []int) {
	return file_capiscio_v1_mcp_proto_rawDescGZIP(), []int{4}
}

// Request to evaluate tool access
type EvaluateToolAccessRequest struct {
	state protoimpl.MessageState `protogen:"open.v1"`
	// Tool name being invoked
	ToolName string `protobuf:"bytes,1,opt,name=tool_name,json=toolName,proto3" json:"tool_name,omitempty"`
	// SHA-256 hash of canonicalized params: "sha256:<base64url>"
	// CRITICAL: Raw params never sent to core - canonicalization happens in wrapper
	ParamsHash string `protobuf:"bytes,2,opt,name=params_hash,json=paramsHash,proto3" json:"params_hash,omitempty"`
	// HTTP origin of the server (e.g., "https://api.example.com")
	ServerOrigin string `protobuf:"bytes,3,opt,name=server_origin,json=serverOrigin,proto3" json:"server_origin,omitempty"`
	// Caller identity - core derives agent_did, badge_jti, auth_level
	//
	// Types that are valid to be assigned to CallerCredential:
	//
	//	*EvaluateToolAccessRequest_BadgeJws
	//	*EvaluateToolAccessRequest_ApiKey
	CallerCredential isEvaluateToolAccessRequest_CallerCredential `protobuf_oneof:"caller_credential"`
	// Optional policy configuration
	PolicyVersion string          `protobuf:"bytes,6,opt,name=policy_version,json=policyVersion,proto3" json:"policy_version,omitempty"`
	Config        *EvaluateConfig `protobuf:"bytes,7,opt,name=config,proto3" json:"config,omitempty"`
	unknownFields protoimpl.UnknownFields
	sizeCache     protoimpl.SizeCache
}

func (x *EvaluateToolAccessRequest) Reset() {
	*x = EvaluateToolAccessRequest{}
	mi := &file_capiscio_v1_mcp_proto_msgTypes[0]
	ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
	ms.StoreMessageInfo(mi)
}

func (x *EvaluateToolAccessRequest) String() string {
	return protoimpl.X.MessageStringOf(x)
}

func (*EvaluateToolAccessRequest) ProtoMessage() {}

func (x *EvaluateToolAccessRequest) ProtoReflect() protoreflect.Message {
	mi := &file_capiscio_v1_mcp_proto_msgTypes[0]
	if x != nil {
		ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
		if ms.LoadMessageInfo() == nil {
			ms.StoreMessageInfo(mi)
		}
		return ms
	}
	return mi.MessageOf(x)
}

// Deprecated: Use EvaluateToolAccessRequest.ProtoReflect.Descriptor instead.
func (*EvaluateToolAccessRequest) Descriptor() ([]byte, []int) {
	return file_capiscio_v1_mcp_proto_rawDescGZIP(), []int{0}
}

func (x *EvaluateToolAccessRequest) GetToolName() string {
	if x != nil {
		return x.ToolName
	}
	return ""
}

func (x *EvaluateToolAccessRequest) GetParamsHash() string {
	if x != nil {
		return x.ParamsHash
	}
	return ""
}

func (x *EvaluateToolAccessRequest) GetServerOrigin() string {
	if x != nil {
		return x.ServerOrigin
	}
	return ""
}

func (x *EvaluateToolAccessRequest) GetCallerCredential() isEvaluateToolAccessRequest_CallerCredential {
	if x != nil {
		return x.CallerCredential
	}
	return nil
}

func (x *EvaluateToolAccessRequest) GetBadgeJws() string {
	if x != nil {
		if x, ok := x.CallerCredential.(*EvaluateToolAccessRequest_BadgeJws); ok {
			return x.BadgeJws
		}
	}
	return ""
}

func (x *EvaluateToolAccessRequest) GetApiKey() string {
	if x != nil {
		if x, ok := x.CallerCredential.(*EvaluateToolAccessRequest_ApiKey); ok {
			return x.ApiKey
		}
	}
	return ""
}

func (x *EvaluateToolAccessRequest) GetPolicyVersion() string {
	if x != nil {
		return x.PolicyVersion
	}
	return ""
}

func (x *EvaluateToolAccessRequest) GetConfig() *EvaluateConfig {
	if x != nil {
		return x.Config
	}
	return nil
}

type isEvaluateToolAccessRequest_CallerCredential interface {
	isEvaluateToolAccessRequest_CallerCredential()
}

type EvaluateToolAccessRequest_BadgeJws struct {
	BadgeJws string `protobuf:"bytes,4,opt,name=badge_jws,json=badgeJws,proto3,oneof"` // Full badge JWT
}

type EvaluateToolAccessRequest_ApiKey struct {
	ApiKey string `protobuf:"bytes,5,opt,name=api_key,json=apiKey,proto3,oneof"` // API key
}

func (*EvaluateToolAccessRequest_BadgeJws) isEvaluateToolAccessRequest_CallerCredential() {}

func (*EvaluateToolAccessRequest_ApiKey) isEvaluateToolAccessRequest_CallerCredential() {}

// Configuration for tool access evaluation
type EvaluateConfig struct {
	state protoimpl.MessageState `protogen:"open.v1"`
	// List of trusted badge issuers
	TrustedIssuers []string `protobuf:"bytes,1,rep,name=trusted_issuers,json=trustedIssuers,proto3" json:"trusted_issuers,omitempty"`
	// Minimum required trust level (0-4, default 0)
	MinTrustLevel int32 `protobuf:"varint,2,opt,name=min_trust_level,json=minTrustLevel,proto3" json:"min_trust_level,omitempty"`
	// Accept self-signed did:key badges (Trust Level 0)
	AcceptLevelZero bool `protobuf:"varint,3,opt,name=accept_level_zero,json=acceptLevelZero,proto3" json:"accept_level_zero,omitempty"`
	// Allowed tool patterns (glob patterns, e.g., "read_*", "fs.*")
	AllowedTools  []string `protobuf:"bytes,4,rep,name=allowed_tools,json=allowedTools,proto3" json:"allowed_tools,omitempty"`
	unknownFields protoimpl.UnknownFields
	sizeCache     protoimpl.SizeCache
}

func (x *EvaluateConfig) Reset() {
	*x = EvaluateConfig{}
	mi := &file_capiscio_v1_mcp_proto_msgTypes[1]
	ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
	ms.StoreMessageInfo(mi)
}

func (x *EvaluateConfig) String() string {
	return protoimpl.X.MessageStringOf(x)
}

func (*EvaluateConfig) ProtoMessage() {}

func (x *EvaluateConfig) ProtoReflect() protoreflect.Message {
	mi := &file_capiscio_v1_mcp_proto_msgTypes[1]
	if x != nil {
		ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
		if ms.LoadMessageInfo() == nil {
			ms.StoreMessageInfo(mi)
		}
		return ms
	}
	return mi.MessageOf(x)
}

// Deprecated: Use EvaluateConfig.ProtoReflect.Descriptor instead.
func (*EvaluateConfig) Descriptor() ([]byte, []int) {
	return file_capiscio_v1_mcp_proto_rawDescGZIP(), []int{1}
}

func (x *EvaluateConfig) GetTrustedIssuers() []string {
	if x != nil {
		return x.TrustedIssuers
	}
	return nil
}

func (x *EvaluateConfig) GetMinTrustLevel() int32 {
	if x != nil {
		return x.MinTrustLevel
	}
	return 0
}

func (x *EvaluateConfig) GetAcceptLevelZero() bool {
	if x != nil {
		return x.AcceptLevelZero
	}
	return false
}

func (x *EvaluateConfig) GetAllowedTools() []string {
	if x != nil {
		return x.AllowedTools
	}
	return nil
}

// Response from tool access evaluation
type EvaluateToolAccessResponse struct {
	state protoimpl.MessageState `protogen:"open.v1"`
	// Access decision
	Decision MCPDecision `protobuf:"varint,1,opt,name=decision,proto3,enum=capiscio.v1.MCPDecision" json:"decision,omitempty"`
	// Reason for denial (only set if decision = DENY)
	DenyReason MCPDenyReason `protobuf:"varint,2,opt,name=deny_reason,json=denyReason,proto3,enum=capiscio.v1.MCPDenyReason" json:"deny_reason,omitempty"`
	// Human-readable denial detail
	DenyDetail string `protobuf:"bytes,3,opt,name=deny_detail,json=denyDetail,proto3" json:"deny_detail,omitempty"`
	// Derived identity (core extracts from credential)
	AgentDid   string       `protobuf:"bytes,4,opt,name=agent_did,json=agentDid,proto3" json:"agent_did,omitempty"`                                   // Extracted from badge/API key
	BadgeJti   string       `protobuf:"bytes,5,opt,name=badge_jti,json=badgeJti,proto3" json:"badge_jti,omitempty"`                                   // Badge ID if present
	AuthLevel  MCPAuthLevel `protobuf:"varint,6,opt,name=auth_level,json=authLevel,proto3,enum=capiscio.v1.MCPAuthLevel" json:"auth_level,omitempty"` // ANONYMOUS, API_KEY, or BADGE
	TrustLevel int32        `protobuf:"varint,7,opt,name=trust_level,json=trustLevel,proto3" json:"trust_level,omitempty"`                            // Verified trust level (0-4)
	// Evidence (single source of truth - no separate EmitEvidence RPC)
	// RFC-006 §7 compliant JSON
	EvidenceJson string `protobuf:"bytes,8,opt,name=evidence_json,json=evidenceJson,proto3" json:"evidence_json,omitempty"`
	// Unique evidence record ID
	EvidenceId string `protobuf:"bytes,9,opt,name=evidence_id,json=evidenceId,proto3" json:"evidence_id,omitempty"`
	// Timestamp of evaluation
	Timestamp     *timestamppb.Timestamp `protobuf:"bytes,10,opt,name=timestamp,proto3" json:"timestamp,omitempty"`
	unknownFields protoimpl.UnknownFields
	sizeCache     protoimpl.SizeCache
}

func (x *EvaluateToolAccessResponse) Reset() {
	*x = EvaluateToolAccessResponse{}
	mi := &file_capiscio_v1_mcp_proto_msgTypes[2]
	ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
	ms.StoreMessageInfo(mi)
}

func (x *EvaluateToolAccessResponse) String() string {
	return protoimpl.X.MessageStringOf(x)
}

func (*EvaluateToolAccessResponse) ProtoMessage() {}

func (x *EvaluateToolAccessResponse) ProtoReflect() protoreflect.Message {
	mi := &file_capiscio_v1_mcp_proto_msgTypes[2]
	if x != nil {
		ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
		if ms.LoadMessageInfo() == nil {
			ms.StoreMessageInfo(mi)
		}
		return ms
	}
	return mi.MessageOf(x)
}

// Deprecated: Use EvaluateToolAccessResponse.ProtoReflect.Descriptor instead.
func (*EvaluateToolAccessResponse) Descriptor() ([]byte, []int) {
	return file_capiscio_v1_mcp_proto_rawDescGZIP(), []int{2}
}

func (x *EvaluateToolAccessResponse) GetDecision() MCPDecision {
	if x != nil {
		return x.Decision
	}
	return MCPDecision_MCP_DECISION_UNSPECIFIED
}

func (x *EvaluateToolAccessResponse) GetDenyReason() MCPDenyReason {
	if x != nil {
		return x.DenyReason
	}
	return MCPDenyReason_MCP_DENY_REASON_UNSPECIFIED
}

func (x *EvaluateToolAccessResponse) GetDenyDetail() string {
	if x != nil {
		return x.DenyDetail
	}
	return ""
}

func (x *EvaluateToolAccessResponse) GetAgentDid() string {
	if x != nil {
		return x.AgentDid
	}
	return ""
}

func (x *EvaluateToolAccessResponse) GetBadgeJti() string {
	if x != nil {
		return x.BadgeJti
	}
	return ""
}

func (x *EvaluateToolAccessResponse) GetAuthLevel() MCPAuthLevel {
	if x != nil {
		return x.AuthLevel
	}
	return MCPAuthLevel_MCP_AUTH_LEVEL_UNSPECIFIED
}

func (x *EvaluateToolAccessResponse) GetTrustLevel() int32 {
	if x != nil {
		return x.TrustLevel
	}
	return 0
}

func (x *EvaluateToolAccessResponse) GetEvidenceJson() string {
	if x != nil {
		return x.EvidenceJson
	}
	return ""
}

func (x *EvaluateToolAccessResponse) GetEvidenceId() string {
	if x != nil {
		return x.EvidenceId
	}
	return ""
}

func (x *EvaluateToolAccessResponse) GetTimestamp() *timestamppb.Timestamp {
	if x != nil {
		return x.Timestamp
	}
	return nil
}

// Request to verify server identity
type VerifyServerIdentityRequest struct {
	state protoimpl.MessageState `protogen:"open.v1"`
	// Disclosed server DID
	ServerDid string `protobuf:"bytes,1,opt,name=server_did,json=serverDid,proto3" json:"server_did,omitempty"`
	// Server trust badge (JWS), optional
	ServerBadge string `protobuf:"bytes,2,opt,name=server_badge,json=serverBadge,proto3" json:"server_badge,omitempty"`
	// HTTP origin for origin binding (empty for stdio)
	TransportOrigin string `protobuf:"bytes,3,opt,name=transport_origin,json=transportOrigin,proto3" json:"transport_origin,omitempty"`
	// URL path for did:web path binding
	EndpointPath string `protobuf:"bytes,4,opt,name=endpoint_path,json=endpointPath,proto3" json:"endpoint_path,omitempty"`
	// Verification configuration
	Config        *MCPVerifyConfig `protobuf:"bytes,5,opt,name=config,proto3" json:"config,omitempty"`
	unknownFields protoimpl.UnknownFields
	sizeCache     protoimpl.SizeCache
}

func (x *VerifyServerIdentityRequest) Reset() {
	*x = VerifyServerIdentityRequest{}
	mi := &file_capiscio_v1_mcp_proto_msgTypes[3]
	ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
	ms.StoreMessageInfo(mi)
}

func (x *VerifyServerIdentityRequest) String() string {
	return protoimpl.X.MessageStringOf(x)
}

func (*VerifyServerIdentityRequest) ProtoMessage() {}

func (x *VerifyServerIdentityRequest) ProtoReflect() protoreflect.Message {
	mi := &file_capiscio_v1_mcp_proto_msgTypes[3]
	if x != nil {
		ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
		if ms.LoadMessageInfo() == nil {
			ms.StoreMessageInfo(mi)
		}
		return ms
	}
	return mi.MessageOf(x)
}

// Deprecated: Use VerifyServerIdentityRequest.ProtoReflect.Descriptor instead.
func (*VerifyServerIdentityRequest) Descriptor() ([]byte, []int) {
	return file_capiscio_v1_mcp_proto_rawDescGZIP(), []int{3}
}

func (x *VerifyServerIdentityRequest) GetServerDid() string {
	if x != nil {
		return x.ServerDid
	}
	return ""
}

func (x *VerifyServerIdentityRequest) GetServerBadge() string {
	if x != nil {
		return x.ServerBadge
	}
	return ""
}

func (x *VerifyServerIdentityRequest) GetTransportOrigin() string {
	if x != nil {
		return x.TransportOrigin
	}
	return ""
}

func (x *VerifyServerIdentityRequest) GetEndpointPath() string {
	if x != nil {
		return x.EndpointPath
	}
	return ""
}

func (x *VerifyServerIdentityRequest) GetConfig() *MCPVerifyConfig {
	if x != nil {
		return x.Config
	}
	return nil
}

// Configuration for server identity verification
type MCPVerifyConfig struct {
	state protoimpl.MessageState `protogen:"open.v1"`
	// List of trusted badge issuers
	TrustedIssuers []string `protobuf:"bytes,1,rep,name=trusted_issuers,json=trustedIssuers,proto3" json:"trusted_issuers,omitempty"`
	// Minimum required trust level (0-4, default 0)
	MinTrustLevel int32 `protobuf:"varint,2,opt,name=min_trust_level,json=minTrustLevel,proto3" json:"min_trust_level,omitempty"`
	// Accept self-signed did:key badges (Trust Level 0)
	AcceptLevelZero bool `protobuf:"varint,3,opt,name=accept_level_zero,json=acceptLevelZero,proto3" json:"accept_level_zero,omitempty"`
	// Skip revocation checks (offline mode)
	OfflineMode bool `protobuf:"varint,4,opt,name=offline_mode,json=offlineMode,proto3" json:"offline_mode,omitempty"`
	// Skip origin binding checks (for trusted gateways)
	SkipOriginBinding bool `protobuf:"varint,5,opt,name=skip_origin_binding,json=skipOriginBinding,proto3" json:"skip_origin_binding,omitempty"`
	unknownFields     protoimpl.UnknownFields
	sizeCache         protoimpl.SizeCache
}

func (x *MCPVerifyConfig) Reset() {
	*x = MCPVerifyConfig{}
	mi := &file_capiscio_v1_mcp_proto_msgTypes[4]
	ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
	ms.StoreMessageInfo(mi)
}

func (x *MCPVerifyConfig) String() string {
	return protoimpl.X.MessageStringOf(x)
}

func (*MCPVerifyConfig) ProtoMessage() {}

func (x *MCPVerifyConfig) ProtoReflect() protoreflect.Message {
	mi := &file_capiscio_v1_mcp_proto_msgTypes[4]
	if x != nil {
		ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
		if ms.LoadMessageInfo() == nil {
			ms.StoreMessageInfo(mi)
		}
		return ms
	}
	return mi.MessageOf(x)
}

// Deprecated: Use MCPVerifyConfig.ProtoReflect.Descriptor instead.
func (*MCPVerifyConfig) Descriptor() ([]byte, []int) {
	return file_capiscio_v1_mcp_proto_rawDescGZIP(), []int{4}
}

func (x *MCPVerifyConfig) GetTrustedIssuers() []string {
	if x != nil {
		return x.TrustedIssuers
	}
	return nil
}

func (x *MCPVerifyConfig) GetMinTrustLevel() int32 {
	if x != nil {
		return x.MinTrustLevel
	}
	return 0
}

func (x *MCPVerifyConfig) GetAcceptLevelZero() bool {
	if x != nil {
		return x.AcceptLevelZero
	}
	return false
}

func (x *MCPVerifyConfig) GetOfflineMode() bool {
	if x != nil {
		return x.OfflineMode
	}
	return false
}

func (x *MCPVerifyConfig) GetSkipOriginBinding() bool {
	if x != nil {
		return x.SkipOriginBinding
	}
	return false
}

// Response from server identity verification
type VerifyServerIdentityResponse struct {
	state protoimpl.MessageState `protogen:"open.v1"`
	// Server classification state (RFC-007 §5.2)
	State MCPServerState `protobuf:"varint,1,opt,name=state,proto3,enum=capiscio.v1.MCPServerState" json:"state,omitempty"`
	// Trust level (only set for VERIFIED_PRINCIPAL)
	TrustLevel int32 `protobuf:"varint,2,opt,name=trust_level,json=trustLevel,proto3" json:"trust_level,omitempty"`
	// Confirmed server DID
	ServerDid string `protobuf:"bytes,3,opt,name=server_did,json=serverDid,proto3" json:"server_did,omitempty"`
	// Badge ID if present
	BadgeJti string `protobuf:"bytes,4,opt,name=badge_jti,json=badgeJti,proto3" json:"badge_jti,omitempty"`
	// Error code (only set on verification failure)
	ErrorCode MCPServerErrorCode `protobuf:"varint,5,opt,name=error_code,json=errorCode,proto3,enum=capiscio.v1.MCPServerErrorCode" json:"error_code,omitempty"`
	// Human-readable error detail
	ErrorDetail   string `protobuf:"bytes,6,opt,name=error_detail,json=errorDetail,proto3" json:"error_detail,omitempty"`
	unknownFields protoimpl.UnknownFields
	sizeCache     protoimpl.SizeCache
}

func (x *VerifyServerIdentityResponse) Reset() {
	*x = VerifyServerIdentityResponse{}
	mi := &file_capiscio_v1_mcp_proto_msgTypes[5]
	ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
	ms.StoreMessageInfo(mi)
}

func (x *VerifyServerIdentityResponse) String() string {
	return protoimpl.X.MessageStringOf(x)
}

func (*VerifyServerIdentityResponse) ProtoMessage() {}

func (x *VerifyServerIdentityResponse) ProtoReflect() protoreflect.Message {
	mi := &file_capiscio_v1_mcp_proto_msgTypes[5]
	if x != nil {
		ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
		if ms.LoadMessageInfo() == nil {
			ms.StoreMessageInfo(mi)
		}
		return ms
	}
	return mi.MessageOf(x)
}

// Deprecated: Use VerifyServerIdentityResponse.ProtoReflect.Descriptor instead.
func (*VerifyServerIdentityResponse) Descriptor() ([]byte, []int) {
	return file_capiscio_v1_mcp_proto_rawDescGZIP(), []int{5}
}

func (x *VerifyServerIdentityResponse) GetState() MCPServerState {
	if x != nil {
		return x.State
	}
	return MCPServerState_MCP_SERVER_STATE_UNSPECIFIED
}

func (x *VerifyServerIdentityResponse) GetTrustLevel() int32 {
	if x != nil {
		return x.TrustLevel
	}
	return 0
}

func (x *VerifyServerIdentityResponse) GetServerDid() string {
	if x != nil {
		return x.ServerDid
	}
	return ""
}

func (x *VerifyServerIdentityResponse) GetBadgeJti() string {
	if x != nil {
		return x.BadgeJti
	}
	return ""
}

func (x *VerifyServerIdentityResponse) GetErrorCode() MCPServerErrorCode {
	if x != nil {
		return x.ErrorCode
	}
	return MCPServerErrorCode_MCP_SERVER_ERROR_NONE
}

func (x *VerifyServerIdentityResponse) GetErrorDetail() string {
	if x != nil {
		return x.ErrorDetail
	}
	return ""
}

// Request to parse server identity from headers/meta
type ParseServerIdentityRequest struct {
	state protoimpl.MessageState `protogen:"open.v1"`
	// Types that are valid to be assigned to Source:
	//
	//	*ParseServerIdentityRequest_HttpHeaders
	//	*ParseServerIdentityRequest_JsonrpcMeta
	Source        isParseServerIdentityRequest_Source `protobuf_oneof:"source"`
	unknownFields protoimpl.UnknownFields
	sizeCache     protoimpl.SizeCache
}

func (x *ParseServerIdentityRequest) Reset() {
	*x = ParseServerIdentityRequest{}
	mi := &file_capiscio_v1_mcp_proto_msgTypes[6]
	ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
	ms.StoreMessageInfo(mi)
}

func (x *ParseServerIdentityRequest) String() string {
	return protoimpl.X.MessageStringOf(x)
}

func (*ParseServerIdentityRequest) ProtoMessage() {}

func (x *ParseServerIdentityRequest) ProtoReflect() protoreflect.Message {
	mi := &file_capiscio_v1_mcp_proto_msgTypes[6]
	if x != nil {
		ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
		if ms.LoadMessageInfo() == nil {
			ms.StoreMessageInfo(mi)
		}
		return ms
	}
	return mi.MessageOf(x)
}

// Deprecated: Use ParseServerIdentityRequest.ProtoReflect.Descriptor instead.
func (*ParseServerIdentityRequest) Descriptor() ([]byte, []int) {
	return file_capiscio_v1_mcp_proto_rawDescGZIP(), []int{6}
}

func (x *ParseServerIdentityRequest) GetSource() isParseServerIdentityRequest_Source {
	if x != nil {
		return x.Source
	}
	return nil
}

func (x *ParseServerIdentityRequest) GetHttpHeaders() *MCPHttpHeaders {
	if x != nil {
		if x, ok := x.Source.(*ParseServerIdentityRequest_HttpHeaders); ok {
			return x.HttpHeaders
		}
	}
	return nil
}

func (x *ParseServerIdentityRequest) GetJsonrpcMeta() *MCPJsonRpcMeta {
	if x != nil {
		if x, ok := x.Source.(*ParseServerIdentityRequest_JsonrpcMeta); ok {
			return x.JsonrpcMeta
		}
	}
	return nil
}

type isParseServerIdentityRequest_Source interface {
	isParseServerIdentityRequest_Source()
}

type ParseServerIdentityRequest_HttpHeaders struct {
	HttpHeaders *MCPHttpHeaders `protobuf:"bytes,1,opt,name=http_headers,json=httpHeaders,proto3,oneof"`
}

type ParseServerIdentityRequest_JsonrpcMeta struct {
	JsonrpcMeta *MCPJsonRpcMeta `protobuf:"bytes,2,opt,name=jsonrpc_meta,json=jsonrpcMeta,proto3,oneof"`
}

func (*ParseServerIdentityRequest_HttpHeaders) isParseServerIdentityRequest_Source() {}

func (*ParseServerIdentityRequest_JsonrpcMeta) isParseServerIdentityRequest_Source() {}

// HTTP headers containing server identity
type MCPHttpHeaders struct {
	state               protoimpl.MessageState `protogen:"open.v1"`
	CapiscioServerDid   string                 `protobuf:"bytes,1,opt,name=capiscio_server_did,json=capiscioServerDid,proto3" json:"capiscio_server_did,omitempty"`
	CapiscioServerBadge string                 `protobuf:"bytes,2,opt,name=capiscio_server_badge,json=capiscioServerBadge,proto3" json:"capiscio_server_badge,omitempty"`
	unknownFields       protoimpl.UnknownFields
	sizeCache           protoimpl.SizeCache
}

func (x *MCPHttpHeaders) Reset() {
	*x = MCPHttpHeaders{}
	mi := &file_capiscio_v1_mcp_proto_msgTypes[7]
	ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
	ms.StoreMessageInfo(mi)
}

func (x *MCPHttpHeaders) String() string {
	return protoimpl.X.MessageStringOf(x)
}

func (*MCPHttpHeaders) ProtoMessage() {}

func (x *MCPHttpHeaders) ProtoReflect() protoreflect.Message {
	mi := &file_capiscio_v1_mcp_proto_msgTypes[7]
	if x != nil {
		ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
		if ms.LoadMessageInfo() == nil {
			ms.StoreMessageInfo(mi)
		}
		return ms
	}
	return mi.MessageOf(x)
}

// Deprecated: Use MCPHttpHeaders.ProtoReflect.Descriptor instead.
func (*MCPHttpHeaders) Descriptor() ([]byte, []int) {
	return file_capiscio_v1_mcp_proto_rawDescGZIP(), []int{7}
}

func (x *MCPHttpHeaders) GetCapiscioServerDid() string {
	if x != nil {
		return x.CapiscioServerDid
	}
	return ""
}

func (x *MCPHttpHeaders) GetCapiscioServerBadge() string {
	if x != nil {
		return x.CapiscioServerBadge
	}
	return ""
}

// JSON-RPC _meta object containing server identity
type MCPJsonRpcMeta struct {
	state protoimpl.MessageState `protogen:"open.v1"`
	// The _meta object as JSON string
	MetaJson      string `protobuf:"bytes,1,opt,name=meta_json,json=metaJson,proto3" json:"meta_json,omitempty"`
	unknownFields protoimpl.UnknownFields
	sizeCache     protoimpl.SizeCache
}

func (x *MCPJsonRpcMeta) Reset() {
	*x = MCPJsonRpcMeta{}
	mi := &file_capiscio_v1_mcp_proto_msgTypes[8]
	ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
	ms.StoreMessageInfo(mi)
}

func (x *MCPJsonRpcMeta) String() string {
	return protoimpl.X.MessageStringOf(x)
}

func (*MCPJsonRpcMeta) ProtoMessage() {}

func (x *MCPJsonRpcMeta) ProtoReflect() protoreflect.Message {
	mi := &file_capiscio_v1_mcp_proto_msgTypes[8]
	if x != nil {
		ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
		if ms.LoadMessageInfo() == nil {
			ms.StoreMessageInfo(mi)
		}
		return ms
	}
	return mi.MessageOf(x)
}

// Deprecated: Use MCPJsonRpcMeta.ProtoReflect.Descriptor instead.
func (*MCPJsonRpcMeta) Descriptor() ([]byte, []int) {
	return file_capiscio_v1_mcp_proto_rawDescGZIP(), []int{8}
}

func (x *MCPJsonRpcMeta) GetMetaJson() string {
	if x != nil {
		return x.MetaJson
	}
	return ""
}

// Response from parsing server identity
type ParseServerIdentityResponse struct {
	state protoimpl.MessageState `protogen:"open.v1"`
	// Extracted server DID
	ServerDid string `protobuf:"bytes,1,opt,name=server_did,json=serverDid,proto3" json:"server_did,omitempty"`
	// Extracted server badge
	ServerBadge string `protobuf:"bytes,2,opt,name=server_badge,json=serverBadge,proto3" json:"server_badge,omitempty"`
	// Whether any identity information was present
	IdentityPresent bool `protobuf:"varint,3,opt,name=identity_present,json=identityPresent,proto3" json:"identity_present,omitempty"`
	unknownFields   protoimpl.UnknownFields
	sizeCache       protoimpl.SizeCache
}

func (x *ParseServerIdentityResponse) Reset() {
	*x = ParseServerIdentityResponse{}
	mi := &file_capiscio_v1_mcp_proto_msgTypes[9]
	ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
	ms.StoreMessageInfo(mi)
}

func (x *ParseServerIdentityResponse) String() string {
	return protoimpl.X.MessageStringOf(x)
}

func (*ParseServerIdentityResponse) ProtoMessage() {}

func (x *ParseServerIdentityResponse) ProtoReflect() protoreflect.Message {
	mi := &file_capiscio_v1_mcp_proto_msgTypes[9]
	if x != nil {
		ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
		if ms.LoadMessageInfo() == nil {
			ms.StoreMessageInfo(mi)
		}
		return ms
	}
	return mi.MessageOf(x)
}

// Deprecated: Use ParseServerIdentityResponse.ProtoReflect.Descriptor instead.
func (*ParseServerIdentityResponse) Descriptor() ([]byte, []int) {
	return file_capiscio_v1_mcp_proto_rawDescGZIP(), []int{9}
}

func (x *ParseServerIdentityResponse) GetServerDid() string {
	if x != nil {
		return x.ServerDid
	}
	return ""
}

func (x *ParseServerIdentityResponse) GetServerBadge() string {
	if x != nil {
		return x.ServerBadge
	}
	return ""
}

func (x *ParseServerIdentityResponse) GetIdentityPresent() bool {
	if x != nil {
		return x.IdentityPresent
	}
	return false
}

// Health check request
type MCPHealthRequest struct {
	state protoimpl.MessageState `protogen:"open.v1"`
	// Client SDK version for compatibility check
	ClientVersion string `protobuf:"bytes,1,opt,name=client_version,json=clientVersion,proto3" json:"client_version,omitempty"`
	unknownFields protoimpl.UnknownFields
	sizeCache     protoimpl.SizeCache
}

func (x *MCPHealthRequest) Reset() {
	*x = MCPHealthRequest{}
	mi := &file_capiscio_v1_mcp_proto_msgTypes[10]
	ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
	ms.StoreMessageInfo(mi)
}

func (x *MCPHealthRequest) String() string {
	return protoimpl.X.MessageStringOf(x)
}

func (*MCPHealthRequest) ProtoMessage() {}

func (x *MCPHealthRequest) ProtoReflect() protoreflect.Message {
	mi := &file_capiscio_v1_mcp_proto_msgTypes[10]
	if x != nil {
		ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
		if ms.LoadMessageInfo() == nil {
			ms.StoreMessageInfo(mi)
		}
		return ms
	}
	return mi.MessageOf(x)
}

// Deprecated: Use MCPHealthRequest.ProtoReflect.Descriptor instead.
func (*MCPHealthRequest) Descriptor() ([]byte, []int) {
	return file_capiscio_v1_mcp_proto_rawDescGZIP(), []int{10}
}

func (x *MCPHealthRequest) GetClientVersion() string {
	if x != nil {
		return x.ClientVersion
	}
	return ""
}

// Health check response
type MCPHealthResponse struct {
	state protoimpl.MessageState `protogen:"open.v1"`
	// Whether the service is healthy
	Healthy bool `protobuf:"varint,1,opt,name=healthy,proto3" json:"healthy,omitempty"`
	// capiscio-core version
	CoreVersion string `protobuf:"bytes,2,opt,name=core_version,json=coreVersion,proto3" json:"core_version,omitempty"`
	// Proto schema version
	ProtoVersion string `protobuf:"bytes,3,opt,name=proto_version,json=protoVersion,proto3" json:"proto_version,omitempty"`
	// Whether client version is compatible with this core
	VersionCompatible bool `protobuf:"varint,4,opt,name=version_compatible,json=versionCompatible,proto3" json:"version_compatible,omitempty"`
	unknownFields     protoimpl.UnknownFields
	sizeCache         protoimpl.SizeCache
}

func (x *MCPHealthResponse) Reset() {
	*x = MCPHealthResponse{}
	mi := &file_capiscio_v1_mcp_proto_msgTypes[11]
	ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
	ms.StoreMessageInfo(mi)
}

func (x *MCPHealthResponse) String() string {
	return protoimpl.X.MessageStringOf(x)
}

func (*MCPHealthResponse) ProtoMessage() {}

func (x *MCPHealthResponse) ProtoReflect() protoreflect.Message {
	mi := &file_capiscio_v1_mcp_proto_msgTypes[11]
	if x != nil {
		ms := protoimpl.X.MessageStateOf(protoimpl.Pointer(x))
		if ms.LoadMessageInfo() == nil {
			ms.StoreMessageInfo(mi)
		}
		return ms
	}
	return mi.MessageOf(x)
}

// Deprecated: Use MCPHealthResponse.ProtoReflect.Descriptor instead.
func (*MCPHealthResponse) Descriptor() ([]byte, []int) {
	return file_capiscio_v1_mcp_proto_rawDescGZIP(), []int{11}
}

func (x *MCPHealthResponse) GetHealthy() bool {
	if x != nil {
		return x.Healthy
	}
	return false
}

func (x *MCPHealthResponse) GetCoreVersion() string {
	if x != nil {
		return x.CoreVersion
	}
	return ""
}

func (x *MCPHealthResponse) GetProtoVersion() string {
	if x != nil {
		return x.ProtoVersion
	}
	return ""
}

func (x *MCPHealthResponse) GetVersionCompatible() bool {
	if x != nil {
		return x.VersionCompatible
	}
	return false
}

var File_capiscio_v1_mcp_proto protoreflect.FileDescriptor

const file_capiscio_v1_mcp_proto_rawDesc = "" +
	"\n" +
	"\x15capiscio/v1/mcp.proto\x12\vcapiscio.v1\x1a\x1fgoogle/protobuf/timestamp.proto\"\xa9\x02\n" +
	"\x19EvaluateToolAccessRequest\x12\x1b\n" +
	"\ttool_name\x18\x01 \x01(\tR\btoolName\x12\x1f\n" +
	"\vparams_hash\x18\x02 \x01(\tR\n" +
	"paramsHash\x12#\n" +
	"\rserver_origin\x18\x03 \x01(\tR\fserverOrigin\x12\x1d\n" +
	"\tbadge_jws\x18\x04 \x01(\tH\x00R\bbadgeJws\x12\x19\n" +
	"\aapi_key\x18\x05 \x01(\tH\x00R\x06apiKey\x12%\n" +
	"\x0epolicy_version\x18\x06 \x01(\tR\rpolicyVersion\x123\n" +
	"\x06config\x18\a \x01(\v2\x1b.capiscio.v1.EvaluateConfigR\x06configB\x13\n" +
	"\x11caller_credential\"\xb2\x01\n" +
	"\x0eEvaluateConfig\x12'\n" +
	"\x0ftrusted_issuers\x18\x01 \x03(\tR\x0etrustedIssuers\x12&\n" +
	"\x0fmin_trust_level\x18\x02 \x01(\x05R\rminTrustLevel\x12*\n" +
	"\x11accept_level_zero\x18\x03 \x01(\bR\x0facceptLevelZero\x12#\n" +
	"\rallowed_tools\x18\x04 \x03(\tR\fallowedTools\"\xc5\x03\n" +
	"\x1aEvaluateToolAccessResponse\x124\n" +
	"\bdecision\x18\x01 \x01(\x0e2\x18.capiscio.v1.MCPDecisionR\bdecision\x12;\n" +
	"\vdeny_reason\x18\x02 \x01(\x0e2\x1a.capiscio.v1.MCPDenyReasonR\n" +
	"denyReason\x12\x1f\n" +
	"\vdeny_detail\x18\x03 \x01(\tR\n" +
	"denyDetail\x12\x1b\n" +
	"\tagent_did\x18\x04 \x01(\tR\bagentDid\x12\x1b\n" +
	"\tbadge_jti\x18\x05 \x01(\tR\bbadgeJti\x128\n" +
	"\n" +
	"auth_level\x18\x06 \x01(\x0e2\x19.capiscio.v1.MCPAuthLevelR\tauthLevel\x12\x1f\n" +
	"\vtrust_level\x18\a \x01(\x05R\n" +
	"trustLevel\x12#\n" +
	"\revidence_json\x18\b \x01(\tR\fevidenceJson\x12\x1f\n" +
	"\vevidence_id\x18\t \x01(\tR\n" +
	"evidenceId\x128\n" +
	"\ttimestamp\x18\n" +
	" \x01(\v2\x1a.google.protobuf.TimestampR\ttimestamp\"\xe5\x01\n" +
	"\x1bVerifyServerIdentityRequest\x12\x1d\n" +
	"\n" +
	"server_did\x18\x01 \x01(\tR\tserverDid\x12!\n" +
	"\fserver_badge\x18\x02 \x01(\tR\vserverBadge\x12)\n" +
	"\x10transport_origin\x18\x03 \x01(\tR\x0ftransportOrigin\x12#\n" +
	"\rendpoint_path\x18\x04 \x01(\tR\fendpointPath\x124\n" +
	"\x06config\x18\x05 \x01(\v2\x1c.capiscio.v1.MCPVerifyConfigR\x06config\"\xe1\x01\n" +
	"\x0fMCPVerifyConfig\x12'\n" +
	"\x0ftrusted_issuers\x18\x01 \x03(\tR\x0etrustedIssuers\x12&\n" +
	"\x0fmin_trust_level\x18\x02 \x01(\x05R\rminTrustLevel\x12*\n" +
	"\x11accept_level_zero\x18\x03 \x01(\bR\x0facceptLevelZero\x12!\n" +
	"\foffline_mode\x18\x04 \x01(\bR\vofflineMode\x12.\n" +
	"\x13skip_origin_binding\x18\x05 \x01(\bR\x11skipOriginBinding\"\x91\x02\n" +
	"\x1cVerifyServerIdentityResponse\x121\n" +
	"\x05state\x18\x01 \x01(\x0e2\x1b.capiscio.v1.MCPServerStateR\x05state\x12\x1f\n" +
	"\vtrust_level\x18\x02 \x01(\x05R\n" +
	"trustLevel\x12\x1d\n" +
	"\n" +
	"server_did\x18\x03 \x01(\tR\tserverDid\x12\x1b\n" +
	"\tbadge_jti\x18\x04 \x01(\tR\bbadgeJti\x12>\n" +
	"\n" +
	"error_code\x18\x05 \x01(\x0e2\x1f.capiscio.v1.MCPServerErrorCodeR\terrorCode\x12!\n" +
	"\ferror_detail\x18\x06 \x01(\tR\verrorDetail\"\xaa\x01\n" +
	"\x1aParseServerIdentityRequest\x12@\n" +
	"\fhttp_headers\x18\x01 \x01(\v2\x1b.capiscio.v1.MCPHttpHeadersH\x00R\vhttpHeaders\x12@\n" +
	"\fjsonrpc_meta\x18\x02 \x01(\v2\x1b.capiscio.v1.MCPJsonRpcMetaH\x00R\vjsonrpcMetaB\b\n" +
	"\x06source\"t\n" +
	"\x0eMCPHttpHeaders\x12.\n" +
	"\x13capiscio_server_did\x18\x01 \x01(\tR\x11capiscioServerDid\x122\n" +
	"\x15capiscio_server_badge\x18\x02 \x01(\tR\x13capiscioServerBadge\"-\n" +
	"\x0eMCPJsonRpcMeta\x12\x1b\n" +
	"\tmeta_json\x18\x01 \x01(\tR\bmetaJson\"\x8a\x01\n" +
	"\x1bParseServerIdentityResponse\x12\x1d\n" +
	"\n" +
	"server_did\x18\x01 \x01(\tR\tserverDid\x12!\n" +
	"\fserver_badge\x18\x02 \x01(\tR\vserverBadge\x12)\n" +
	"\x10identity_present\x18\x03 \x01(\bR\x0fidentityPresent\"9\n" +
	"\x10MCPHealthRequest\x12%\n" +
	"\x0eclient_version\x18\x01 \x01(\tR\rclientVersion\"\xa4\x01\n" +
	"\x11MCPHealthResponse\x12\x18\n" +
	"\ahealthy\x18\x01 \x01(\bR\ahealthy\x12!\n" +
	"\fcore_version\x18\x02 \x01(\tR\vcoreVersion\x12#\n" +
	"\rproto_version\x18\x03 \x01(\tR\fprotoVersion\x12-\n" +
	"\x12version_compatible\x18\x04 \x01(\bR\x11versionCompatible*Z\n" +
	"\vMCPDecision\x12\x1c\n" +
	"\x18MCP_DECISION_UNSPECIFIED\x10\x00\x12\x16\n" +
	"\x12MCP_DECISION_ALLOW\x10\x01\x12\x15\n" +
	"\x11MCP_DECISION_DENY\x10\x02*\x82\x01\n" +
	"\fMCPAuthLevel\x12\x1e\n" +
	"\x1aMCP_AUTH_LEVEL_UNSPECIFIED\x10\x00\x12\x1c\n" +
	"\x18MCP_AUTH_LEVEL_ANONYMOUS\x10\x01\x12\x1a\n" +
	"\x16MCP_AUTH_LEVEL_API_KEY\x10\x02\x12\x18\n" +
	"\x14MCP_AUTH_LEVEL_BADGE\x10\x03*\xd3\x02\n" +
	"\rMCPDenyReason\x12\x1f\n" +
	"\x1bMCP_DENY_REASON_UNSPECIFIED\x10\x00\x12!\n" +
	"\x1dMCP_DENY_REASON_BADGE_MISSING\x10\x01\x12!\n" +
	"\x1dMCP_DENY_REASON_BADGE_INVALID\x10\x02\x12!\n" +
	"\x1dMCP_DENY_REASON_BADGE_EXPIRED\x10\x03\x12!\n" +
	"\x1dMCP_DENY_REASON_BADGE_REVOKED\x10\x04\x12&\n" +
	"\"MCP_DENY_REASON_TRUST_INSUFFICIENT\x10\x05\x12$\n" +
	" MCP_DENY_REASON_TOOL_NOT_ALLOWED\x10\x06\x12$\n" +
	" MCP_DENY_REASON_ISSUER_UNTRUSTED\x10\a\x12!\n" +
	"\x1dMCP_DENY_REASON_POLICY_DENIED\x10\b*\xac\x01\n" +
	"\x0eMCPServerState\x12 \n" +
	"\x1cMCP_SERVER_STATE_UNSPECIFIED\x10\x00\x12'\n" +
	"#MCP_SERVER_STATE_VERIFIED_PRINCIPAL\x10\x01\x12'\n" +
	"#MCP_SERVER_STATE_DECLARED_PRINCIPAL\x10\x02\x12&\n" +
	"\"MCP_SERVER_STATE_UNVERIFIED_ORIGIN\x10\x03*\xd7\x02\n" +
	"\x12MCPServerErrorCode\x12\x19\n" +
	"\x15MCP_SERVER_ERROR_NONE\x10\x00\x12 \n" +
	"\x1cMCP_SERVER_ERROR_DID_INVALID\x10\x01\x12\"\n" +
	"\x1eMCP_SERVER_ERROR_BADGE_INVALID\x10\x02\x12\"\n" +
	"\x1eMCP_SERVER_ERROR_BADGE_EXPIRED\x10\x03\x12\"\n" +
	"\x1eMCP_SERVER_ERROR_BADGE_REVOKED\x10\x04\x12'\n" +
	"#MCP_SERVER_ERROR_TRUST_INSUFFICIENT\x10\x05\x12$\n" +
	" MCP_SERVER_ERROR_ORIGIN_MISMATCH\x10\x06\x12\"\n" +
	"\x1eMCP_SERVER_ERROR_PATH_MISMATCH\x10\a\x12%\n" +
	"!MCP_SERVER_ERROR_ISSUER_UNTRUSTED\x10\b2\x93\x03\n" +
	"\n" +
	"MCPService\x12e\n" +
	"\x12EvaluateToolAccess\x12&.capiscio.v1.EvaluateToolAccessRequest\x1a'.capiscio.v1.EvaluateToolAccessResponse\x12k\n" +
	"\x14VerifyServerIdentity\x12(.capiscio.v1.VerifyServerIdentityRequest\x1a).capiscio.v1.VerifyServerIdentityResponse\x12h\n" +
	"\x13ParseServerIdentity\x12'.capiscio.v1.ParseServerIdentityRequest\x1a(.capiscio.v1.ParseServerIdentityResponse\x12G\n" +
	"\x06Health\x12\x1d.capiscio.v1.MCPHealthRequest\x1a\x1e.capiscio.v1.MCPHealthResponseB\xae\x01\n" +
	"\x0fcom.capiscio.v1B\bMcpProtoP\x01ZDgithub.com/capiscio/capiscio-core/pkg/rpc/gen/capiscio/v1;capisciov1\xa2\x02\x03CXX\xaa\x02\vCapiscio.V1\xca\x02\vCapiscio\\V1\xe2\x02\x17Capiscio\\V1\\GPBMetadata\xea\x02\fCapiscio::V1b\x06proto3"

var (
	file_capiscio_v1_mcp_proto_rawDescOnce sync.Once
	file_capiscio_v1_mcp_proto_rawDescData []byte
)

func file_capiscio_v1_mcp_proto_rawDescGZIP() []byte {
	file_capiscio_v1_mcp_proto_rawDescOnce.Do(func() {
		file_capiscio_v1_mcp_proto_rawDescData = protoimpl.X.CompressGZIP(unsafe.Slice(unsafe.StringData(file_capiscio_v1_mcp_proto_rawDesc), len(file_capiscio_v1_mcp_proto_rawDesc)))
	})
	return file_capiscio_v1_mcp_proto_rawDescData
}

var file_capiscio_v1_mcp_proto_enumTypes = make([]protoimpl.EnumInfo, 5)
var file_capiscio_v1_mcp_proto_msgTypes = make([]protoimpl.MessageInfo, 12)
var file_capiscio_v1_mcp_proto_goTypes = []any{
	(MCPDecision)(0),                     // 0: capiscio.v1.MCPDecision
	(MCPAuthLevel)(0),                    // 1: capiscio.v1.MCPAuthLevel
	(MCPDenyReason)(0),                   // 2: capiscio.v1.MCPDenyReason
	(MCPServerState)(0),                  // 3: capiscio.v1.MCPServerState
	(MCPServerErrorCode)(0),              // 4: capiscio.v1.MCPServerErrorCode
	(*EvaluateToolAccessRequest)(nil),    // 5: capiscio.v1.EvaluateToolAccessRequest
	(*EvaluateConfig)(nil),               // 6: capiscio.v1.EvaluateConfig
	(*EvaluateToolAccessResponse)(nil),   // 7: capiscio.v1.EvaluateToolAccessResponse
	(*VerifyServerIdentityRequest)(nil),  // 8: capiscio.v1.VerifyServerIdentityRequest
	(*MCPVerifyConfig)(nil),              // 9: capiscio.v1.MCPVerifyConfig
	(*VerifyServerIdentityResponse)(nil), // 10: capiscio.v1.VerifyServerIdentityResponse
	(*ParseServerIdentityRequest)(nil),   // 11: capiscio.v1.ParseServerIdentityRequest
	(*MCPHttpHeaders)(nil),               // 12: capiscio.v1.MCPHttpHeaders
	(*MCPJsonRpcMeta)(nil),               // 13: capiscio.v1.MCPJsonRpcMeta
	(*ParseServerIdentityResponse)(nil),  // 14: capiscio.v1.ParseServerIdentityResponse
	(*MCPHealthRequest)(nil),             // 15: capiscio.v1.MCPHealthRequest
	(*MCPHealthResponse)(nil),            // 16: capiscio.v1.MCPHealthResponse
	(*timestamppb.Timestamp)(nil),        // 17: google.protobuf.Timestamp
}
var file_capiscio_v1_mcp_proto_depIdxs = []int32{
	6,  // 0: capiscio.v1.EvaluateToolAccessRequest.config:type_name -> capiscio.v1.EvaluateConfig
	0,  // 1: capiscio.v1.EvaluateToolAccessResponse.decision:type_name -> capiscio.v1.MCPDecision
	2,  // 2: capiscio.v1.EvaluateToolAccessResponse.deny_reason:type_name -> capiscio.v1.MCPDenyReason
	1,  // 3: capiscio.v1.EvaluateToolAccessResponse.auth_level:type_name -> capiscio.v1.MCPAuthLevel
	17, // 4: capiscio.v1.EvaluateToolAccessResponse.timestamp:type_name -> google.protobuf.Timestamp
	9,  // 5: capiscio.v1.VerifyServerIdentityRequest.config:type_name -> capiscio.v1.MCPVerifyConfig
	3,  // 6: capiscio.v1.VerifyServerIdentityResponse.state:type_name -> capiscio.v1.MCPServerState
	4,  // 7: capiscio.v1.VerifyServerIdentityResponse.error_code:type_name -> capiscio.v1.MCPServerErrorCode
	12, // 8: capiscio.v1.ParseServerIdentityRequest.http_headers:type_name -> capiscio.v1.MCPHttpHeaders
	13, // 9: capiscio.v1.ParseServerIdentityRequest.jsonrpc_meta:type_name -> capiscio.v1.MCPJsonRpcMeta
	5,  // 10: capiscio.v1.MCPService.EvaluateToolAccess:input_type -> capiscio.v1.EvaluateToolAccessRequest
	8,  // 11: capiscio.v1.MCPService.VerifyServerIdentity:input_type -> capiscio.v1.VerifyServerIdentityRequest
	11, // 12: capiscio.v1.MCPService.ParseServerIdentity:input_type -> capiscio.v1.ParseServerIdentityRequest
	15, // 13: capiscio.v1.MCPService.Health:input_type -> capiscio.v1.MCPHealthRequest
	7,  // 14: capiscio.v1.MCPService.EvaluateToolAccess:output_type -> capiscio.v1.EvaluateToolAccessResponse
	10, // 15: capiscio.v1.MCPService.VerifyServerIdentity:output_type -> capiscio.v1.VerifyServerIdentityResponse
	14, // 16: capiscio.v1.MCPService.ParseServerIdentity:output_type -> capiscio.v1.ParseServerIdentityResponse
	16, // 17: capiscio.v1.MCPService.Health:output_type -> capiscio.v1.MCPHealthResponse
	14, // [14:18] is the sub-list for method output_type
	10, // [10:14] is the sub-list for method input_type
	10, // [10:10] is the sub-list for extension type_name
	10, // [10:10] is the sub-list for extension extendee
	0,  // [0:10] is the sub-list for field type_name
}

func init() { file_capiscio_v1_mcp_proto_init() }
func file_capiscio_v1_mcp_proto_init() {
	if File_capiscio_v1_mcp_proto != nil {
		return
	}
	file_capiscio_v1_mcp_proto_msgTypes[0].OneofWrappers = []any{
		(*EvaluateToolAccessRequest_BadgeJws)(nil),
		(*EvaluateToolAccessRequest_ApiKey)(nil),
	}
	file_capiscio_v1_mcp_proto_msgTypes[6].OneofWrappers = []any{
		(*ParseServerIdentityRequest_HttpHeaders)(nil),
		(*ParseServerIdentityRequest_JsonrpcMeta)(nil),
	}
	type x struct{}
	out := protoimpl.TypeBuilder{
		File: protoimpl.DescBuilder{
			GoPackagePath: reflect.TypeOf(x{}).PkgPath(),
			RawDescriptor: unsafe.Slice(unsafe.StringData(file_capiscio_v1_mcp_proto_rawDesc), len(file_capiscio_v1_mcp_proto_rawDesc)),
			NumEnums:      5,
			NumMessages:   12,
			NumExtensions: 0,
			NumServices:   1,
		},
		GoTypes:           file_capiscio_v1_mcp_proto_goTypes,
		DependencyIndexes: file_capiscio_v1_mcp_proto_depIdxs,
		EnumInfos:         file_capiscio_v1_mcp_proto_enumTypes,
		MessageInfos:      file_capiscio_v1_mcp_proto_msgTypes,
	}.Build()
	File_capiscio_v1_mcp_proto = out.File
	file_capiscio_v1_mcp_proto_goTypes = nil
	file_capiscio_v1_mcp_proto_depIdxs = nil
}
